# Server-side game configuration
game:
  # The rate at which the game loop runs, in ticks per second.
  tick_rate: 20
  
  # Interval in ticks between batch database syncs.
  # All gameplay data (inventory, equipment, skills, ground items) is cached in
  # Valkey and batch-written to PostgreSQL at this interval.
  # 200 ticks at 20 TPS = sync every 10 seconds
  # Lower values = more frequent saves, higher DB load
  # Higher values = less DB load, more data loss on crash
  db_sync_interval_ticks: 200
  
  # Movement configuration
  movement:
    # Minimum time between moves in seconds (prevents spam)
    move_cooldown: 0.15  # 150ms = ~6.7 moves per second max
    # Duration of movement animation on client
    animation_duration: 0.15  # Match cooldown for smooth continuous movement

  # HP regeneration configuration
  hp_regen:
    # Interval in ticks between HP regeneration (1 HP per interval)
    # At 20 TPS: 200 ticks = 10 seconds
    interval_ticks: 200
  
  # Death and respawn configuration
  death:
    # Time in seconds before player respawns after death
    respawn_delay: 5
  
  # Default spawn configuration for new players
  spawn:
    map_id: "samplemap"
    x: 25
    y: 25

  # Chat system configuration
  chat:
    global:
      enabled: true
      allowed_roles: ["ADMIN", "MODERATOR"]  # Roles that can send global messages
    max_message_length:
      local: 280      # Local chat character limit
      global: 200     # Global chat character limit (shorter to prevent spam)
      dm: 500         # Direct message character limit
    rate_limits:
      local: 1.0      # Seconds between local messages
      global: 5.0     # Seconds between global messages
      dm: 0.5         # Seconds between DMs
    local_chunk_radius: 2  # Chunks radius for local chat (32 tile radius with 16x16 chunks)

  # Security and rate limiting configuration
  security:
    # Maximum length of chat messages (longer messages are truncated) - DEPRECATED: Use chat.max_message_length instead
    chat_max_message_length: 500
    # Minimum time between inventory operations (move, sort, drop, pickup) in seconds
    inventory_operation_cooldown: 0.1
    # Minimum time between equipment operations (equip, unequip) in seconds
    equipment_operation_cooldown: 0.1
    # Minimum time between combat attacks in seconds (600ms = 100 attacks per minute)
    combat_attack_cooldown: 0.6

  # Combat configuration
  combat:
    # Unarmed attack speed (seconds between attacks)
    base_attack_speed: 3.0
    # Melee attacks require target to be within this many tiles
    melee_max_range: 1
    # Auto-stop combat if target moves this far away (tiles)
    combat_break_distance: 3
    # Ticks before entity despawns after death (10 ticks = 0.5s @ 20 TPS)
    death_animation_ticks: 10

  # Entity AI configuration
  entity_ai:
    # Enable/disable entity AI processing
    enabled: true
    # Ticks between wander movements (40 ticks = 2 seconds @ 20 TPS)
    wander_interval_ticks: 40
    # Ticks between chase movements (10 ticks = 0.5 seconds @ 20 TPS)
    chase_interval_ticks: 10
    # Base ticks between entity attacks (60 ticks = 3 seconds @ 20 TPS)
    attack_interval_ticks: 60
    # Ticks between aggro scans (5 ticks = 0.25 seconds @ 20 TPS)
    aggro_check_interval_ticks: 5
    # Ticks without LOS before entity loses aggro (100 ticks = 5 seconds @ 20 TPS)
    los_timeout_ticks: 100
    # Maximum A* pathfinding search distance (tiles)
    max_pathfinding_distance: 50
    # Minimum idle time before wandering (ticks)
    idle_to_wander_min_ticks: 20
    # Maximum idle time before wandering (ticks)
    idle_to_wander_max_ticks: 100

  # Authentication/session configuration
  auth:
    # How long access tokens are valid (in minutes)
    access_token_expire_minutes: 30

  # Skills configuration
  skills:
    # Maximum level a skill can reach
    max_level: 99
    
    # Default XP multiplier for skills not explicitly configured
    # 1.0 = standard RuneScape curve (~13M XP to level 99)
    default_xp_multiplier: 1.0
    
    # Per-skill XP multipliers
    # Lower values = faster leveling, Higher values = slower leveling
    # Examples:
    #   0.5 = ~6.5M XP to 99 (twice as fast)
    #   1.0 = ~13M XP to 99 (standard)
    #   2.0 = ~26M XP to 99 (twice as slow)
    xp_multipliers:
      # Combat skills
      attack: 1.0
      strength: 1.0
      defence: 1.0
      hitpoints: 1.0
      # Gathering skills (slightly faster progression)
      mining: 0.8
      fishing: 0.8
      woodcutting: 0.8
      # Crafting skills
      cooking: 0.7
      crafting: 1.0

  # Inventory configuration
  inventory:
    # Number of inventory slots per player
    max_slots: 28

  # Equipment and durability configuration
  equipment:
    # How much durability is lost per combat action
    durability_loss_per_hit: 1
    # Repair cost = item_value * multiplier * damage_percent
    repair_cost_multiplier: 0.1

  # Ground items configuration
  ground_items:
    # Despawn times in seconds (item disappears from ground)
    # Based on item rarity - rarer items last longer
    despawn_times:
      poor: 60        # 1 minute
      common: 120     # 2 minutes
      uncommon: 180   # 3 minutes
      rare: 300       # 5 minutes
      epic: 600       # 10 minutes
      legendary: 900  # 15 minutes
    
    # Loot protection times in seconds
    # During this time, only the player who dropped the item can pick it up
    # After this time, anyone can pick it up (first come first serve)
    loot_protection_times:
      poor: 30        # 30 seconds
      common: 45      # 45 seconds
      uncommon: 60    # 1 minute
      rare: 90        # 1.5 minutes
      epic: 120       # 2 minutes
      legendary: 180  # 3 minutes
    
    # How often the cleanup task runs to remove expired items (seconds)
    cleanup_interval: 30

# Cache configuration
cache:
  # TTL for offline player data when auto-loaded (seconds)
  # Online players stay in cache indefinitely with no TTL
  # Offline players are removed from cache immediately on logout/timeout
  offline_player_ttl_seconds: 1800 # 30 minutes - only for auto-loaded offline players

# Server infrastructure settings
server:
  # Player capacity management
  capacity:
    # Maximum number of concurrent players allowed
    # Admins and moderators can always connect, even when at capacity
    # 0 = unlimited (not recommended for production)
    max_players: 500
  
  # Valkey (Redis-compatible) connection settings
  valkey:
    host: "valkey"
    port: 6379
